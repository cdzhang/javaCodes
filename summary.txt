When calculate long precisely, Math.pow is not a good method.

for(i=0;i<N;i++){
   int ai = A[i];
   for(j=0;j<M;j++){
      //change ai here may cause unwanted results
   }
}

Get the last M elements from an array a, if a.length < M, get them all

Collections.sort();
LinkedList<T> a;
a.contains(t) returns true if a contains t;
If I don't know where goes wrong, read line by line is one method to find the bug

